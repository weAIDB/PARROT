CREATE FUNCTION total_value() RETURNS DECIMAL(12,2)
AS
BEGIN
    RETURN (
        SELECT SUM(PS_SUPPLYCOST * PS_AVAILQTY) * 0.0001000000
        FROM PARTSUPP
        JOIN SUPPLIER ON PS_SUPPKEY = S_SUPPKEY
        JOIN NATION ON S_NATIONKEY = N_NATIONKEY
        WHERE N_NAME = 'GERMANY'
    );
END;
