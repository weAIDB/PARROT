SELECT L_SHIPMODE,
SUM(dbo.line_count(O_ORDERPRIORITY, 'high')) AS HIGH_LINE_COUNT,
SUM(dbo.line_count(O_ORDERPRIORITY, 'low')) AS LOW_LINE_COUNT
FROM ORDERS, LINEITEM
WHERE O_ORDERKEY = L_ORDERKEY AND
dbo.q12conditions(L_SHIPMODE, L_COMMITDATE, L_RECEIPTDATE, L_SHIPDATE) = 1
GROUP BY L_SHIPMODE
ORDER BY L_SHIPMODE;