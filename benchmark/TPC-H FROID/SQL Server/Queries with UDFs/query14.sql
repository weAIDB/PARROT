SELECT 100.00 *
SUM(dbo.promo_disc(P_TYPE, L_EXTENDEDPRICE, L_DISCOUNT))
/ SUM(dbo.discount_price(L_EXTENDEDPRICE, L_DISCOUNT))
AS PROMO_REVENUE
FROM LINEITEM, PART
WHERE L_PARTKEY = P_PARTKEY AND L_SHIPDATE >= '1995-09-01'
AND L_SHIPDATE < dateadd(mm, 1, '1995-09-01');